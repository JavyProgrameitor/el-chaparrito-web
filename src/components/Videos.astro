---
const vids = [
  {
    label: "Cosecha de cereal",
    youtubeId: "https://youtube.com/shorts/n8XVYyIbnDQ",
    poster: "/posters/poster-cereal.jpg",
  },
  {
    label: "Cosecha de tomate",
    youtubeId: "https://youtube.com/shorts/KeMcqzyPPS0",
    poster: "/posters/poster-tomate.jpg",
  },
  {
    label: "Siembra",
    youtubeId: "https://youtube.com/shorts/X1Iwf6DS-LE",
    poster: "/posters/poster-siembra.jpg",
  },
  {
    label: "Cosecha de maíz",
    youtubeId: "https://youtu.be/Je6a-oadxa8",
    poster: "/posters/poster-maiz.jpg",
  },
];
---

<section style="padding: 10px 16px 24px; max-width: 1000px; margin: 0 auto;">
  <h2>Vídeos de trabajos</h2>
  <div
    style="display:grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap:12px;"
  >
    {
      vids.map((v) => (
        <div style="position:relative; padding-top:56.25%; border-radius:12px; overflow:hidden;">
          <div
            class="yt"
            data-id={v.youtubeId}
            style="position:relative; padding-top:56.25%; border-radius:12px; overflow:hidden; background:#000;"
          >
            <button
              type="button"
              class="yt-btn"
              aria-label={"Reproducir " + v.label}
              style="all:unset; cursor:pointer; position:absolute; inset:0; display:block;"
            >
              <img
                src={v.poster}
                alt={v.label}
                loading="lazy"
                style="position:absolute; inset:0; width:100%; height:100%; object-fit:cover;"
              />
              <span
                style="
        position:absolute; inset:0;
        display:grid; place-items:center;
        background: linear-gradient(rgba(0,0,0,.25), rgba(0,0,0,.25));
      "
              >
                <span
                  style="
          width:76px; height:76px; border-radius:999px;
          background: rgba(255,255,255,.92);
          display:grid; place-items:center;
        "
                >
                  <span
                    style="
          display:block; width:0; height:0;
          border-left:18px solid #000;
          border-top:12px solid transparent;
          border-bottom:12px solid transparent;
          margin-left:4px;
        "
                  />
                </span>
              </span>
            </button>
          </div>
        </div>
      ))
    }
  </div>
</section>
<script>
  document.addEventListener("click", (event) => {
    const target = event.target;
    if (!(target instanceof Element)) return;

    const btn = target.closest(".yt-btn");
    if (!btn) return;

    const wrap = btn.closest(".yt");
    if (!wrap) return;

    const id = wrap.getAttribute("data-id");
    if (!id) return;

    wrap.innerHTML = `
      <iframe
        src="https://www.youtube.com/embed/${id}?autoplay=1"
        title="YouTube video player"
        loading="lazy"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen
        style="position:absolute; inset:0; width:100%; height:100%; border:0;"
      ></iframe>
    `;
  });
</script>
